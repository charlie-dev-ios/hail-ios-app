# アーキテクチャ設計方針

## アーキテクチャ
- 本アプリはTCA（The Composable Architecture）を採用し、状態管理・画面遷移・副作用処理を一元的に管理します。
- マルチモジュール構成を採用し、各機能ごとにFeatureモジュール（例: DashboardFeature, WorkbenchFeature など）を分離します。
- 通信層や共通UIなどは専用のモジュール（例: APIClient, CommonUI）として切り出します。

## モジュール構成（2025年6月6日現在）

- Modules/
    - RootFeature/
    - DashboardFeature/

各FeatureはTCAのReducer/State/Action/Viewをテンプレート（scripts/natura-templates/Feature.xctemplate）に従い実装します。

## 実装ルール
- 各FeatureのState/Actionは@ObservableState/@Reducerマクロを利用し、テンプレートに準拠すること。
- ルートのRootFeatureは各タブのFeatureをScopeで管理し、TabViewで各Viewを表示します。
- モジュール追加時はModules/Package.swiftのproducts/targets/extension Stringに必ず追記します。
- StoreのスコープはTCAのscopeメソッドで明示的に分割し、各タブのViewに渡します。
- コードは可読性を重視し、適度に改行・インデントを行います。

## 設計ドキュメントの書き方

- 設計ドキュメントは、実際のプロジェクト構成・実装ルール・設計方針・テンプレート運用・命名規則など、開発チーム全体で守るべき内容を明確に記載してください。
- モジュール構成は「例」ではなく、現時点の実際のディレクトリ構成を記載し、将来の予定や仮の記述は避けてください。
- ファイル名の記載は原則不要です。ディレクトリ単位・モジュール単位で記載してください。
- 実装ルールや設計方針は、具体的な記述例やテンプレートパスを明示し、誰が見ても迷わないようにします。
- コード例は可読性を重視し、適度な改行・インデントを行ってください。
- ドキュメントの更新日やバージョンが分かるよう、日付を明記することを推奨します。
- 追加・変更があった場合は、必ず設計ドキュメントも最新状態に保つようにしてください。

## 参考テンプレート
- scripts/natura-templates/Feature.xctemplate/___VARIABLE_featureName___.swift

## 例: RootFeatureのTabView実装
```swift
public var body: some View {
    TabView {
        DashboardView(
            store: store.scope(
                state: \.dashboard,
                action: \.dashboard
            )
        )
        .tabItem {
            Label(
                "Dashboard",
                systemImage: "rectangle.grid.2x2"
            )
        }
    }
}
```
